{{/* Full page — for direct access / non-HTMX */}}
{{define "user-dashboard"}}
{{template "app-shell" .}}
{{end}}

{{/* Content-only partial — for HTMX navigation */}}
{{define "user-dashboard-content"}}
<div class="page-content" data-page-css="/assets/css/entydad/entydad-user-dashboard.css?v={{.CacheVersion}}">
    <!-- Stats Row -->
    <div class="entydad-stats-row">
        {{template "stat-card" dict "Icon" "icon-shield" "Value" (printf "%d" .Stats.TotalUsers) "Label" "Total Users" "Trend" "" "TrendUp" true "Color" "terracotta"}}
        {{template "stat-card" dict "Icon" "icon-user-check" "Value" (printf "%d" .Stats.ActiveUsers) "Label" "Active" "Trend" "" "TrendUp" true "Color" "sage"}}
        {{template "stat-card" dict "Icon" "icon-user-minus" "Value" (printf "%d" .Stats.InactiveUsers) "Label" "Inactive" "Trend" "" "TrendUp" false "Color" "navy"}}
        {{template "stat-card" dict "Icon" "icon-shield" "Value" (printf "%d" .Stats.TotalRoles) "Label" "Roles" "Trend" "" "TrendUp" true "Color" "amber"}}
    </div>

    <!-- Main Grid -->
    <div class="entydad-dashboard-grid">
        <!-- User Activity Chart -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">User Activity</h2>
                <div class="card-actions">
                    <a href="?period=week" class="card-btn{{if eq .ActivePeriod "week"}} primary{{end}}">Week</a>
                    <a href="?period=month" class="card-btn{{if eq .ActivePeriod "month"}} primary{{end}}">Month</a>
                    <a href="?period=year" class="card-btn{{if eq .ActivePeriod "year"}} primary{{end}}">Year</a>
                </div>
            </div>
            <div class="entydad-chart-area">
                <div class="entydad-chart-placeholder">
                    <div class="entydad-chart-line">
                        <svg viewBox="0 0 400 200" preserveAspectRatio="none">
                            <defs>
                                <linearGradient id="chartGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                                    <stop offset="0%" style="stop-color:#7A9E7A;stop-opacity:0.3" />
                                    <stop offset="100%" style="stop-color:#7A9E7A;stop-opacity:0" />
                                </linearGradient>
                            </defs>
                            {{if .ChartSVGPath}}
                            <path d="{{.ChartSVGPath}}" fill="none" stroke="#7A9E7A" stroke-width="3" stroke-linecap="round"/>
                            <path d="{{.ChartFillPath}}" fill="url(#chartGradient)"/>
                            {{else}}
                            <path d="M0,160 Q50,140 100,120 T200,100 T300,110 T400,60" fill="none" stroke="#7A9E7A" stroke-width="3" stroke-linecap="round"/>
                            <path d="M0,160 Q50,140 100,120 T200,100 T300,110 T400,60 L400,200 L0,200 Z" fill="url(#chartGradient)"/>
                            {{end}}
                        </svg>
                    </div>
                    <div class="entydad-chart-labels">
                        {{if .ChartData.Labels}}
                            {{range .ChartData.Labels}}
                            <span class="entydad-chart-label">{{.}}</span>
                            {{end}}
                        {{else}}
                            <span class="entydad-chart-label">Jan</span>
                            <span class="entydad-chart-label">Mar</span>
                            <span class="entydad-chart-label">May</span>
                            <span class="entydad-chart-label">Jul</span>
                            <span class="entydad-chart-label">Sep</span>
                            <span class="entydad-chart-label">Nov</span>
                        {{end}}
                    </div>
                </div>
            </div>
        </div>

        <!-- Recent Activity -->
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">Recent Activity</h2>
                <button class="card-btn">View All</button>
            </div>
            <div class="entydad-activity-list">
                {{if .RecentActivity}}
                    {{range .RecentActivity}}
                    <div class="entydad-activity-item">
                        <div class="entydad-activity-icon">
                            {{.IconHTML}}
                        </div>
                        <div class="entydad-activity-content">
                            <div class="entydad-activity-title">{{.Title}}</div>
                            <div class="entydad-activity-desc">{{.Description}}</div>
                        </div>
                        <span class="entydad-activity-time">{{.TimeAgo}}</span>
                    </div>
                    {{end}}
                {{else}}
                <div class="entydad-activity-empty">
                    <p>No recent activity</p>
                </div>
                {{end}}
            </div>
        </div>
    </div>
</div>
{{end}}
